---
layout: page
description: "「离开世界之前 一切都是过程」"
---

<div class="dz-layout post-list">
  <!-- 左列：文章卡片流 -->
  <div class="post-col">
    {% for post in paginator.posts %}
    <article class="card post-card">
      <a class="post-link" href="{{ post.url | prepend: site.baseurl }}">
        <h2 class="post-title">{{ post.title }}</h2>
        {% if post.subtitle %}
          <h3 class="post-subtitle">{{ post.subtitle }}</h3>
        {% endif %}
        <p class="excerpt">
          {% if post.lang == 'en' %}
            {{ post.content | strip_html | truncate: 300 }}
          {% else %}
            {{ post.content | strip_html | truncate: 200 }}
          {% endif %}
        </p>
      </a>
      <div class="post-meta">
        <span>{{ post.date | date: "%Y-%m-%d" }}</span>
        {% if post.tags and post.tags.size > 0 %}
          <span class="dot">•</span>
          <span class="tags">
            {% for t in post.tags limit:3 %}
              <span class="tag">{{ t }}</span>
            {% endfor %}
          </span>
        {% endif %}
      </div>
    </article>
    {% endfor %}

    {% if paginator.total_pages > 1 %}
    <ul class="pager pager-clean">
      {% if paginator.previous_page %}
      <li class="previous">
        <a class="btn btn-pager" href="{{ paginator.previous_page_path | prepend: site.baseurl | replace: '//', '/' }}">&larr; 上一页</a>
      </li>
      {% endif %}
      {% if paginator.next_page %}
      <li class="next">
        <a class="btn btn-pager" href="{{ paginator.next_page_path | prepend: site.baseurl | replace: '//', '/' }}">下一页 &rarr;</a>
      </li>
      {% endif %}
    </ul>
    {% endif %}
  </div>

  <!-- 右列：人物徽章（不规则紧密排布），不再使用“卡片” -->
  <aside class="sidebar-col">
    <section class="persona">
      <div class="persona-head">
        <img class="avatar" src="{{ site.sidebar-avatar | default: '/img/avatar.jpg' | prepend: site.baseurl }}" alt="{{ site.title }}">
        <div class="meta">
          <div class="name">{{ site.title }}</div>
          <div class="desc">{{ site.sidebar-about-description }}</div>
        </div>
      </div>

      <!-- 不规则徽章：用多列 masonry 效果 -->
      <ul class="persona-badges">
        {% if site.zhihu_username_text %}
          {% if site.zhihu_username %}
            <li class="chip chip--lg"><a href="https://www.zhihu.com/people/{{ site.zhihu_username }}" target="_blank" rel="noopener">知乎 · {{ site.zhihu_username_text }}</a></li>
          {% else %}
            <li class="chip chip--lg">知乎 · {{ site.zhihu_username_text }}</li>
          {% endif %}
        {% endif %}

        {% if site.github_username %}
          <li class="chip"><a href="https://github.com/{{ site.github_username }}" target="_blank" rel="noopener">GitHub · {{ site.github_username }}</a></li>
        {% endif %}

        {% if site.twitter_username %}
          <li class="chip chip--md"><a href="https://twitter.com/{{ site.twitter_username | remove: '@' }}" target="_blank" rel="noopener">Twitter · {{ site.twitter_username }}</a></li>
        {% endif %}

        {% if site.bilibili_uid %}
          <li class="chip"><a href="https://space.bilibili.com/{{ site.bilibili_uid }}" target="_blank" rel="noopener">Bilibili · {{ site.bilibili_username | default: '个人主页' }}</a></li>
        {% endif %}

        {% if site.wechat_official_name %}
          <li class="chip chip--sm mute">公众号 · {{ site.wechat_official_name }}</li>
        {% endif %}
      </ul>
    </section>
  </aside>
</div>

<!-- 最右：书签式文章轨道（只此一处） -->
<div id="bookmark-rail" class="bookmark-rail">
  <ul class="bm-ul">
    {% assign _sorted = site.posts | sort: 'date' | reverse %}
    {% for p in _sorted %}
      <li class="bm-item">
        <a class="bm-link" href="{{ p.url | prepend: site.baseurl }}">
          <span class="bm-panel">
            <span class="bm-title">{{ p.title }}</span>
            <span class="bm-date">{{ p.date | date: "%m-%d" }}</span>
          </span>
          <span class="bm-tab">{{ p.title }}</span>
        </a>
      </li>
    {% endfor %}
  </ul>
</div>

<script>
/* —— 防重渲染：如果某处误又插入了 bookmark-rail，移除多余 —— */
(function(){
  var rails = document.querySelectorAll('#bookmark-rail');
  if (rails.length > 1) {
    for (var i = 1; i < rails.length; i++) {
      rails[i].parentNode.removeChild(rails[i]);
    }
  }
})();

/* —— 书签轨道滚动控制（与 CSS 联动） —— */
(function(){
  var rail = document.getElementById('bookmark-rail');
  if(!rail) return;

  var ul = rail.querySelector('.bm-ul');
  var items = ul ? ul.querySelectorAll('.bm-item') : [];

  var H = 56;       // 每根卡高度(含间距)
  var visible = 7;  // 一屏显示 7 根
  var idx = 0;

  if(items.length <= 5){
    rail.style.height = 'auto';
    rail.style.paddingTop = '0';
    rail.style.paddingBottom = '0';
    rail.style.overflow = 'visible';
  }

  function maxIdx(){ return Math.max(0, items.length - visible); }
  function update(){ ul.style.transform = 'translateY(' + (-idx * H) + 'px)'; }
  update();

  function scrollBy(d){
    var m = maxIdx();
    if(m === 0) return;
    idx = Math.min(m, Math.max(0, idx + d));
    update();
  }

  rail.addEventListener('wheel', function(e){
    if(maxIdx() === 0) return;
    e.preventDefault();
    scrollBy((e.deltaY > 0) ? 1 : -1);
  }, { passive:false });

  window.addEventListener('keydown', function(e){
    if(maxIdx() === 0) return;
    if(e.key === 'ArrowDown') scrollBy(1);
    if(e.key === 'ArrowUp')   scrollBy(-1);
  });
})();
</script>
