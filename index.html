---
layout: page
description: "「离开世界之前 一切都是过程」"
---

<div class="dz-layout post-list is-masonry">
  <!-- 瀑布流容器：人物卡 + 文章卡（同风格） -->
  <div id="masonry" class="masonry">

    <!-- 人物卡：样式与文章卡一致 -->
    <article class="m-item card post-card">
      <a class="post-link" href="{{ site.baseurl }}/about/">
        <h2 class="post-title">心哲空间</h2>
        <h3 class="post-subtitle">{{ site.sidebar-about-description }}</h3>
        <p class="excerpt">
          GitHub · {{ site.github_username }}
          {% if site.twitter_username %}　·　Twitter · {{ site.twitter_username }}{% endif %}
          {% if site.zhihu_username_text %}　·　知乎 · {{ site.zhihu_username_text }}{% endif %}
          {% if site.wechat_official_name %}　·　公众号 · {{ site.wechat_official_name }}{% endif %}
        </p>
      </a>
      <div class="post-meta"><span>关于本站 / Profile</span></div>
    </article>

    {% for post in paginator.posts %}
    <article class="m-item card post-card">
      <a class="post-link" href="{{ post.url | prepend: site.baseurl }}">
        <h2 class="post-title">{{ post.title }}</h2>
        {% if post.subtitle %}
          <h3 class="post-subtitle">{{ post.subtitle }}</h3>
        {% endif %}
        <p class="excerpt">
          {% if post.lang == 'en' %}
            {{ post.content | strip_html | truncate: 300 }}
          {% else %}
            {{ post.content | strip_html | truncate: 200 }}
          {% endif %}
        </p>
      </a>
      <div class="post-meta">
        <span>{{ post.date | date: "%Y-%m-%d" }}</span>
        {% if post.tags and post.tags.size > 0 %}
          <span class="dot">•</span>
          <span class="tags">
            {% for t in post.tags limit:3 %}
              <span class="tag">{{ t }}</span>
            {% endfor %}
          </span>
        {% endif %}
      </div>
    </article>
    {% endfor %}
  </div>

  <!-- 翻页 -->
  {% if paginator.total_pages > 1 %}
  <ul class="pager pager-clean">
    {% if paginator.previous_page %}
    <li class="previous">
      <a class="btn btn-pager" href="{{ paginator.previous_page_path | prepend: site.baseurl | replace: '//', '/' }}">&larr; 上一页</a>
    </li>
    {% endif %}
    {% if paginator.next_page %}
    <li class="next">
      <a class="btn btn-pager" href="{{ paginator.next_page_path | prepend: site.baseurl | replace: '//', '/' }}">下一页 &rarr;</a>
    </li>
    {% endif %}
  </ul>
  {% endif %}
</div>

<!-- 最右：书签式文章轨道（只保留这一条） -->
<div id="bookmark-rail" class="bookmark-rail">
  <ul class="bm-ul">
    {% assign _sorted = site.posts | sort: 'date' | reverse %}
    {% for p in _sorted %}
      <li class="bm-item">
        <a class="bm-link" href="{{ p.url | prepend: site.baseurl }}">
          <span class="bm-panel">
            <span class="bm-title">{{ p.title }}</span>
            <span class="bm-date">{{ p.date | date: "%m-%d" }}</span>
          </span>
          <span class="bm-tab">{{ p.title }}</span>
        </a>
      </li>
    {% endfor %}
  </ul>
</div>

<script>
/* —— 防止“卡片条”重复：无论哪个文件又渲染了，统统只留一个 —— */
(function(){
  var railsById = document.querySelectorAll('#bookmark-rail');
  if (railsById.length > 1) for (var i = 1; i < railsById.length; i++) railsById[i].remove();
  var railsByClass = document.querySelectorAll('.bookmark-rail');
  if (railsByClass.length > 1) for (var i = 1; i < railsByClass.length; i++) railsByClass[i].remove();
})();

/* —— 书签轨道滚动（露出约 1/3，文章≤5时自动无“半隐”） —— */
(function(){
  var rail = document.getElementById('bookmark-rail'); if(!rail) return;
  var ul = rail.querySelector('.bm-ul'), items = ul.querySelectorAll('.bm-item');
  var H = 56, visible = 7, idx = 0;
  if(items.length <= 5){ rail.style.height='auto'; rail.style.paddingTop='0'; rail.style.paddingBottom='0'; rail.style.overflow='visible'; }
  function maxIdx(){ return Math.max(0, items.length - visible); }
  function update(){ ul.style.transform = 'translateY(' + (-idx * H) + 'px)'; }
  function scrollBy(d){ var m=maxIdx(); if(m===0) return; idx=Math.min(m, Math.max(0, idx+d)); update(); }
  update();
  rail.addEventListener('wheel', function(e){ if(maxIdx()===0) return; e.preventDefault(); scrollBy((e.deltaY>0)?1:-1); }, {passive:false});
  window.addEventListener('keydown', function(e){ if(maxIdx()===0) return; if(e.key==='ArrowDown') scrollBy(1); if(e.key==='ArrowUp') scrollBy(-1); });
})();

/* —— Masonry列识别 + 悬停交互：本列上移，邻列下移 —— */
(function(){
  var grid = document.getElementById('masonry'); if(!grid) return;
  function markColumns(){
    var items = Array.from(grid.querySelectorAll('.m-item'));
    if (items.length === 0) return;
    // 以offsetLeft分组得到列
    var xs = Array.from(new Set(items.map(function(it){ return it.offsetLeft; }))).sort(function(a,b){return a-b;});
    items.forEach(function(it){ it.dataset.col = xs.indexOf(it.offsetLeft); });
    grid.dataset.cols = xs.length;
  }
  var recalc = function(){ markColumns(); };
  window.addEventListener('load', recalc);
  window.addEventListener('resize', function(){ setTimeout(recalc, 200); });
  markColumns();

  var SHIFT = 8; // px
  function reset(){ grid.querySelectorAll('.m-item').forEach(function(it){ it.style.transform=''; }); }
  grid.addEventListener('mouseover', function(e){
    var card = e.target.closest('.m-item'); if(!card) return;
    var col = parseInt(card.dataset.col || -1), cols = parseInt(grid.dataset.cols || 0);
    if(col < 0) return;
    reset();
    grid.querySelectorAll('.m-item').forEach(function(it){
      var c = parseInt(it.dataset.col || -1);
      if(c === col){ it.style.transform = 'translateY(-'+SHIFT+'px)'; }
      else if(c === col-1 || c === col+1){ it.style.transform = 'translateY('+SHIFT+'px)'; }
    });
  }, true);
  grid.addEventListener('mouseleave', reset);
})();
</script>
