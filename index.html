---
layout: page
description: "「离开世界之前 一切都是过程」"
---

<div class="dz-layout post-list">
  <!-- 左列：文章卡片流 -->
  <div class="post-col">
    {% for post in paginator.posts %}
    <article class="card post-card">
      <a class="post-link" href="{{ post.url | prepend: site.baseurl }}">
        <h2 class="post-title">{{ post.title }}</h2>
        {% if post.subtitle %}
          <h3 class="post-subtitle">{{ post.subtitle }}</h3>
        {% endif %}
        <p class="excerpt">
          {% if post.lang == 'en' %}
            {{ post.content | strip_html | truncate: 300 }}
          {% else %}
            {{ post.content | strip_html | truncate: 200 }}
          {% endif %}
        </p>
      </a>
      <div class="post-meta">
        <span>{{ post.date | date: "%Y-%m-%d" }}</span>
        {% if post.tags and post.tags.size > 0 %}
          <span class="dot">•</span>
          <span class="tags">
            {% for t in post.tags limit:3 %}
              <span class="tag">{{ t }}</span>
            {% endfor %}
          </span>
        {% endif %}
      </div>
    </article>
    {% endfor %}

    {% if paginator.total_pages > 1 %}
    <ul class="pager pager-clean">
      {% if paginator.previous_page %}
      <li class="previous">
        <a class="btn btn-pager" href="{{ paginator.previous_page_path | prepend: site.baseurl | replace: '//', '/' }}">&larr; 上一页</a>
      </li>
      {% endif %}
      {% if paginator.next_page %}
      <li class="next">
        <a class="btn btn-pager" href="{{ paginator.next_page_path | prepend: site.baseurl | replace: '//', '/' }}">下一页 &rarr;</a>
      </li>
      {% endif %}
    </ul>
    {% endif %}
  </div>

  <!-- 右列：人物侧栏 + 目录卡（宽版） -->
  <aside class="sidebar-col">
    <section class="card author-card">
      <div class="author-head">
        <img class="avatar" src="{{ site.sidebar-avatar | default: '/img/avatar.jpg' }}" alt="avatar">
        <div class="meta">
          <div class="name">心哲空间</div>
          <div class="desc">{{ site.sidebar-about-description }}</div>
          <ul class="sns-vert">
            {% if site.zhihu_username %}<li><a href="https://www.zhihu.com/people/{{ site.zhihu_username }}" target="_blank" rel="noopener">知乎 · {{ site.zhihu_display | default: site.zhihu_username }}</a></li>{% endif %}
            {% if site.github_username %}<li><a href="https://github.com/{{ site.github_username }}" target="_blank" rel="noopener">GitHub · {{ site.github_username }}</a></li>{% endif %}
            {% if site.twitter_username %}<li><a href="https://twitter.com/{{ site.twitter_username | replace:'@','' }}" target="_blank" rel="noopener">Twitter · {{ site.twitter_username }}</a></li>{% endif %}
            {% if site.bilibili_username %}<li><a href="https://space.bilibili.com/{{ site.bilibili_uid }}" target="_blank" rel="noopener">Bilibili · {{ site.bilibili_username }}</a></li>{% endif %}
            {% if site.wechat_official_name %}<li><span class="sns-mute">公众号 · {{ site.wechat_official_name }}</span></li>{% endif %}
          </ul>
        </div>
      </div>
    </section>

    <section class="card directory-card">
      <h6 class="card-title">最新文章</h6>
      <div class="dir-list">
        {% assign _sorted = site.posts | sort: 'date' | reverse %}
        {% for p in _sorted limit: 40 %}
        <div class="dir-item">
          <a href="{{ p.url | prepend: site.baseurl }}" title="{{ p.title }}">{{ p.title }}</a>
          <span class="dir-date">{{ p.date | date: "%m-%d" }}</span>
        </div>
        {% endfor %}
      </div>
    </section>
  </aside>
</div>

<!-- 最右侧：书签式滑出目录（细长小卡片） -->
<div id="bookmark-rail" class="bookmark-rail">
  <ul class="bm-ul">
    {% assign _sorted = site.posts | sort: 'date' | reverse %}
    {% for p in _sorted %}
    <li class="bm-item">
      <a class="bm-link" href="{{ p.url | prepend: site.baseurl }}" title="{{ p.title }}">
        <span class="bm-panel">
          <span class="bm-title">{{ p.title }}</span>
          <span class="bm-date">{{ p.date | date: "%m-%d" }}</span>
        </span>
        <span class="bm-tab">{{ p.title | truncate: 6 }}</span>
      </a>
    </li>
    {% endfor %}
  </ul>
</div>

<script>
(function(){
  var rail = document.getElementById('bookmark-rail');
  if(!rail) return;
  var ul = rail.querySelector('.bm-ul');
  var items = ul.querySelectorAll('.bm-item');

  var H = 56;          // 单卡总高（css 里 bm-item 52px + margin 2+2）
  var visible = 7;     // 一屏显示数量（上下“半隐”由容器裁剪实现）
  var idx = 0, lock = false;

  // 少量文章（≤5）：关闭半隐与滚动，完整展示
  if(items.length <= 5){
    rail.style.height = 'auto';
    rail.style.paddingTop = '0';
    rail.style.paddingBottom = '0';
    rail.style.overflow = 'visible';
  }

  function maxIdx(){
    if(items.length <= visible) return 0;
    return Math.max(0, items.length - visible);
  }
  function update(){ ul.style.transform = 'translateY(' + (-idx * H) + 'px)'; }
  update();

  function scrollBy(dir){
    var m = maxIdx();
    if(m === 0) return;
    idx = Math.min(m, Math.max(0, idx + dir));
    update();
  }

  rail.addEventListener('wheel', function(e){
    var m = maxIdx();
    if(m === 0) return; // 让页面正常滚动
    e.preventDefault();
    if(lock) return;
    lock = true;
    scrollBy(e.deltaY > 0 ? 1 : -1);
    setTimeout(function(){ lock = false; }, 160);
  }, { passive:false });

  window.addEventListener('keydown', function(e){
    if(maxIdx() === 0) return;
    if(e.key === 'ArrowDown') scrollBy(1);
    if(e.key === 'ArrowUp')   scrollBy(-1);
  });
})();
</script>
